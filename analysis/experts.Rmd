---
title: "experts"
author: "jjtimmons"
date: "7/28/2018"
output: html_document
---

# Regress outcome on expert point predictions

## Load source data from historical folder

```{r}

dir <- "/Users/jtimmons/Documents/GitHub/ff/data/historical"
setwd(dir)

sources <- list(
  list(
    source = "CBS",
    name = "name_cbs",
    pts = "pts_cbs",
    years = c(2012, 2013, 2014)
  ),
  list(
    source = "FOX",
    name = "name_fox",
    pts = "pts_fox",
    years = c(2014)
  ),
  list(
    source = "ESPN",
    name = "name_espn",
    pts = "pts_espn",
    years = c(2012, 2013, 2014)
  ),
  list(
    source = "NFL",
    name = "name_nfl",
    pts = "pts_nfl",
    years = c(2012, 2013, 2014)
  ),
  list(
    source = "Yahoo",
    name = "name_yahoo",
    pts = "pts_yahoo",
    years = c(2014)
  )
)

load("~/Documents/GitHub/ff/data/player_data.Rda")
player.data <- player.data[player.data$year >= 2007,]
player.data <- pdata.frame(player.data, index=c("name","year"), drop.index=FALSE, row.names=TRUE)

for (src in sources) {
  # for (year in src$years) {
  year <- 2014
  hist.data.path <- paste0(dir, "/", src$source, "-Projections-", year, ".RData")
  d <- load(hist.data.path)
  fr <- get(d)
  fr <- fr[!duplicated(fr[src$name]),]
  
  # create the column
  col.name <- paste0(tolower(src$source), ".", year)
  player.data[, col.name] <- NA
  
  # get names and points out of the data frame
  source.data <- data.frame(name = fr[, src$name])
  source.data[col.name] <- fr[, paste0("pts_", tolower(src$source))]
  
  # add the point values in player.data
  player.data <- merge(player.data, source.data, by = "name", all.x = TRUE)
  player.data[col.name] <- player.data[, paste0(col.name, ".y")]
  player.data[paste0(col.name, ".x")] <- NULL
  player.data[paste0(col.name, ".y")] <- NULL
}

t <- player.data[player.data$year == 2014,]

```